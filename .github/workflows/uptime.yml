name: Uptime check
on:
  schedule: [{ cron: "*/5 * * * *" }]
  workflow_dispatch:
jobs:
  ping:
    runs-on: ubuntu-latest
    steps:
      - name: Check staging
        run: |
          URL="${{ secrets.LGFC_STAGING_URL }}"
          [ -n "$URL" ] || { echo "::warning::LGFC_STAGING_URL missing"; exit 0; }
          code=$(curl -s -o /dev/null -w "%{http_code}" "$URL/api/healthz" || true)
          [ "$code" = 200 ] || { echo "::error::staging $code"; exit 1; }
      - name: Check production
        run: |
          URL="${{ secrets.LGFC_PROD_URL }}"
          [ -n "$URL" ] || { echo "::warning::LGFC_PROD_URL missing"; exit 0; }
          code=$(curl -s -o /dev/null -w "%{http_code}" "$URL/api/healthz" || true)
          [ "$code" = 200 ] || { echo "::error::prod $code"; exit 1; }
