name: uptime (optional)
on:
  workflow_dispatch:
  schedule: [{ cron: "*/5 * * * *" }]
jobs:
  ping:
    runs-on: ubuntu-latest
    steps:
      - name: staging
        run: |
          URL="${{ secrets.LGFC_STAGING_URL }}"
          [ -z "$URL" ] && { echo "no staging URL secret yet"; exit 0; }
          code=$(curl -s -o /dev/null -w "%{http_code}" "$URL/api/healthz" || true)
          [ "$code" = "200" ] || { echo "::error::staging $code"; exit 1; }
      - name: production
        run: |
          URL="${{ secrets.LGFC_PROD_URL }}"
          [ -z "$URL" ] && { echo "no prod URL secret yet"; exit 0; }
          code=$(curl -s -o /dev/null -w "%{http_code}" "$URL/api/healthz" || true)
          [ "$code" = "200" ] || { echo "::error::prod $code"; exit 1; }
